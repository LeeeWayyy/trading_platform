[pytest]
pythonpath = .
asyncio_mode = auto
# Specific test directories only - avoids traversing all source files during collection
# This speeds up collection by ~90% compared to scanning apps/ and libs/ entirely
testpaths =
    tests
    scripts/ai_workflow/tests
    libs/redis_client/tests
    libs/risk_management/tests
    apps/execution_gateway/tests
    apps/signal_service/tests
    apps/market_data_service/tests
    apps/orchestrator/tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
# Coverage is opt-in: use `make test-cov` or `pytest --cov=libs --cov=apps`
# Removing from addopts speeds up collection by ~90%
addopts =
    -v
    --strict-markers
    --ignore=tests/integration
    --ignore=tests/e2e
# Include tests nested inside libs (e.g., libs/risk_management/tests/)
norecursedirs = .* build dist *.egg-info node_modules __pycache__ .venv
markers =
    unit: Unit tests
    integration: Integration tests (require model_registry data, skipped in CI)
    slow: Slow tests
    asyncio: Async tests using pytest-asyncio
    e2e: End-to-end tests (require full system setup)
    performance: Performance benchmarks

# Integration tests require:
# - Seeded model_registry table with alpha_baseline model
# - Test data files in data/adjusted/
#
# Run integration tests locally:
#   pytest -m integration
#
# Skip integration tests (CI default):
#   pytest -m "not integration"
